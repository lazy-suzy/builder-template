<!DOCTYPE html>
<html>
  <head>
    <title>Lazysuzy Piranha templates</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
      integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
      crossorigin="anonymous"
    />
    <link
      rel="stylesheet"
      href="http://cdn.materialdesignicons.com/4.7.95/css/materialdesignicons.min.css"
    />

    <link href="./styles.css" rel="stylesheet" />
  </head>
  <body>
    <div>
      <div class="header container-fluid">
        <div class="row">
          <div class="col-4">
            <div class="logo">
              <img
                src="https://www.lazysuzy.com/images/color_logo_transparent.png"
              />
            </div>
          </div>
          <div class="col-8 text-right">
            <div class="header-right-icons">
              <span> The Lazy Story</span>
              <i class="mdi mdi-heart-outline" aria-hidden="true"></i>
              <a href="#" class="auth-link">
                <i
                  class="mdi mdi-account-circle js-open-auth"
                  aria-hidden="true"
                ></i>
              </a>
              <a href="#" class="name-link" style="display: none;">
                <i class="mdi mdi-account-circle" aria-hidden="true"></i>
                <span class="js-userName"></span>
              </a>
            </div>
          </div>
        </div>
      </div>
      <div class="board-list-container container">
        <div class="board-list-header">
          <h5 class="title">MY BOARDS</h5>
        </div>
        <div class="row" id="board-list"></div>
      </div>
      <div class="footer">
        <div class="row">
          <div class="col-6">
            <div class="footer-text sm">Â© 2019 LazySuzy</div>
            <span class="footer-text sm d-md-none">
              <a href="/privacypolicy">Privacy Policy</a>
              <span>|</span>
              <a href="/termsofservice">Terms of service</a>
            </span>
          </div>
          <div class="col-6 text-right">
            <div class="footer-text d-md-none">
              <a href="/aboutus">The Lazy Story</a>
            </div>
            <div class="footer-text">
              Connect With Us
              <a
                target="_blank"
                href="//www.facebook.com/shoplazysuzy"
                class="-icon"
                ><i class="fab fa-facebook-f -cicon"></i
              ></a>
            </div>
            <div class="footer-text d-none d-md-block">
              <a href="/privacypolicy">Privacy Policy</a>
              <span>|</span>
              <a href="/termsofservice">Terms of service</a>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="backdrop"></div>
    <div class="modal canvas-config pb-0">
      <div class="row">
        <div class="col-12">
          <h4 class="board-header">CREATE NEW BOARD</h4>
          <h5 class="title ml-2">Select Layout Style</h5>
        </div>
        <div class="col-6 ">
          <div class="canvas-style" target="#board-options-modal">
            <div class="canvas-layout"></div>
            <h5>BOARD</h5>
          </div>
        </div>
        <div class="col-6 text-center">
          <div class="canvas-style" target="#room-options-modal">
            <div class="canvas-layout canvas-layout-room"></div>
            <h5>ROOM</h5>
          </div>
        </div>
        <div class="col-12 d-none canvas-options" id="board-options-modal">
          <h5 class="title ml-2 mt-4">Select Canvas Color</h5>
          <div class="canvas-pallete">
            <div class="canvas-pallete-color color-pallete-1"></div>
            <div class="canvas-pallete-color color-pallete-2"></div>
            <div class="canvas-pallete-color color-pallete-3"></div>
            <div class="canvas-pallete-color color-pallete-4"></div>
            <div class="canvas-pallete-color color-pallete-5"></div>
            <div class="canvas-pallete-color color-pallete-6"></div>
          </div>
          <div class="canvas-pallete">
            <div class="canvas-pallete-color color-pallete-7"></div>
            <div class="canvas-pallete-color color-pallete-8"></div>
            <div class="canvas-pallete-color color-pallete-9"></div>
            <div class="canvas-pallete-color color-pallete-10"></div>
            <div class="canvas-pallete-color color-pallete-11"></div>
            <div class="canvas-pallete-color color-pallete-12"></div>
          </div>
          <!-- <h5 class="title ml-1 mt-4">Customize Dimensions</h5>
          <div class="dimension-wrapper">
            <div class="dimension-options">
              <input class="dimension-input" placeholder="Width" value="500">
              <label class="ml-2">W</label>
            </div>
            <div class="dimension-options">
              <input class="dimension-input" placeholder="Height" value="500">
              <label class="ml-2">H</label>
            </div>
            <div class="dimension-options">px</div>
          </div> -->
        </div>
        <div class="col-12 d-none canvas-options" id="room-options-modal">
          <!-- <h5 class="title ml-2 mt-4">Select Wall Color</h5>
          <div class="canvas-pallete-wrapper">
            <div id="container" class="canvas-pallete-scroll canvas-container" >
              <div id="canvasPalleteScrollContents" class="canvas-pallete-scroll-contents">
                  <div  class="canvas-pallete-color color-white" aria-selected="true"></div>
                  <div  class="canvas-pallete-color color-red"></div>
                  <div  class="canvas-pallete-color color-black"></div>
                  <div  class="canvas-pallete-color color-gray"></div>
                  <div  class="canvas-pallete-color color-blue"></div>
                  <div  class="canvas-pallete-color color-green"></div>
                  <div  class="canvas-pallete-color color-white"></div>
                  <div  class="canvas-pallete-color color-red"></div>
                  <div  class="canvas-pallete-color color-black"></div>
                  <div  class="canvas-pallete-color color-gray"></div>
                  <div  class="canvas-pallete-color color-blue"></div>
                  <div  class="canvas-pallete-color color-green"></div>  
              </div>
            </div>
            <button id="slideBack" class="canvas-scroll js-left-scroll canvas-scroll-left" type="button">
              <svg class="canvas-scroll-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024"><path d="M445.44 38.183L-2.53 512l447.97 473.817 85.857-81.173-409.6-433.23v81.172l409.6-433.23L445.44 38.18z"/></svg>
            </button>
            <button id="slide" class="canvas-scroll js-right-scroll canvas-scroll-right" type="button">
              <svg class="canvas-scroll-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024"><path d="M105.56 985.817L553.53 512 105.56 38.183l-85.857 81.173 409.6 433.23v-81.172l-409.6 433.23 85.856 81.174z"/></svg>
            </button>
          </div> -->
          <h5 class="title ml-2 mt-4">Select Canvas Background</h5>
          <!-- <h6 class="flooring-options ml-2">Carpet</h6>
              <div class="canvas-pallete-wrapper">
                <div id="container2" class="canvas-pallete-scroll canvas-container" >
                  <div id="canvasPalleteScrollContents" class="canvas-pallete-scroll-contents">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                    <img src="./flooring-pattern.jpg" class="canvas-pallete-carpet-patterns">
                  </div>
                </div>
                <button id="slideBack2" class="canvas-scroll js-left-scroll canvas-scroll-left" type="button">
                  <svg class="canvas-scroll-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024"><path d="M445.44 38.183L-2.53 512l447.97 473.817 85.857-81.173-409.6-433.23v81.172l409.6-433.23L445.44 38.18z"/></svg>
                </button>
                <button id="slide2" class="canvas-scroll js-right-scroll canvas-scroll-right" type="button">
                  <svg class="canvas-scroll-icon" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 551 1024"><path d="M105.56 985.817L553.53 512 105.56 38.183l-85.857 81.173 409.6 433.23v-81.172l-409.6 433.23 85.856 81.174z"/></svg>
                </button>
              </div> -->
          <!-- <h6 class="flooring-options ml-2">Wood</h6> -->
          <div class="canvas-pallete-wrapper">
            <div id="container3" class="canvas-pallete-scroll canvas-container">
              <div
                id="canvasPalleteScrollContents"
                class="canvas-pallete-scroll-contents"
              >
                <img
                  src="./uploads/floor1.jpg"
                  class="canvas-pallete-wood-patterns"
                />
                <img
                  src="./uploads/floor2.jpg"
                  class="canvas-pallete-wood-patterns"
                />
                <img
                  src="./uploads/floor3.jpg"
                  class="canvas-pallete-wood-patterns"
                />
                <img
                  src="./uploads/floor4.jpg"
                  class="canvas-pallete-wood-patterns"
                />
              </div>
            </div>
            <button
              id="slideBack3"
              class="canvas-scroll js-left-scroll canvas-scroll-left"
              type="button"
            >
              <svg
                class="canvas-scroll-icon"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 551 1024"
              >
                <path
                  d="M445.44 38.183L-2.53 512l447.97 473.817 85.857-81.173-409.6-433.23v81.172l409.6-433.23L445.44 38.18z"
                />
              </svg>
            </button>
            <button
              id="slide3"
              class="canvas-scroll js-right-scroll canvas-scroll-right"
              type="button"
            >
              <svg
                class="canvas-scroll-icon"
                xmlns="http://www.w3.org/2000/svg"
                viewBox="0 0 551 1024"
              >
                <path
                  d="M105.56 985.817L553.53 512 105.56 38.183l-85.857 81.173 409.6 433.23v-81.172l-409.6 433.23 85.856 81.174z"
                />
              </svg>
            </button>
          </div>
          <!-- <h5 class="title ml-1 mt-4">Customize Dimensions</h5>
              <div class="dimension-wrapper">
                <div class="dimension-options">
                  <input class="dimension-input" placeholder="Width" value="500">
                  <label class="ml-2">W</label>
                </div>
                <div class="dimension-options">
                  <input class="dimension-input" placeholder="Height" value="500">
                  <label class="ml-2">H</label>
                </div>
                <div class="dimension-options">px</div>
              </div> -->
        </div>
      </div>
      <div class="row modal-action mt-4 mb-4">
        <div class="col-6 text-right">
          <button class="btn btn-cancel js-close-config-modal">Cancel</button>
        </div>
        <div class="col-6">
          <button class="btn red-button js-btn-go">Go</button>
        </div>
      </div>
    </div>
    <div class="modal confirmation-modal text-center">
      <div>
        Are you sure? This can't be undone.
      </div>
      <div class="row modal-action mt-4 mb-4">
        <div class="col-6 text-right">
          <button class="btn red-button" data-action="delete">DELETE</button>
        </div>
        <div class="col-6">
          <button class="btn btn-cancel" data-action="cancel">CANCEL</button>
        </div>
      </div>
    </div>
    <script
      src="https://code.jquery.com/jquery-3.4.1.min.js"
      integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
      crossorigin="anonymous"
    ></script>
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@2.2.1/src/js.cookie.min.js"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/handlebars.js/4.5.3/handlebars.min.js"
      crossorigin="anonymous"
    ></script>
    <script type="text/template" id="board-template">
      <div class="col-sm-3">
        <div class="board-card box-shadow-0">
          <div class="canvas-preview">
            <div class="add-board" data-action="create">
              <div class="add-board-icon">
                  <i class="mdi mdi-plus-box-outline js-open-config cursor-pointer" aria-hidden="true"></i>
              </div>
              <div>
                Start new design
              </div>
            </div>
          </div>
        </div>
      </div>
      {{#each board}}
        {{#with this}}
          <div class="col-sm-3">
            <div class="board-card">
              <div class="canvas-preview" data-board="{{@index}}">
                  <img width="100%" class="edit-board" src="{{#if preview}}{{preview}}{{else}}#{{/if}}"/>
                  <div class="board-card-icons">
                    <span data-title="Edit" data-action="edit">
                      <i class="mdi mdi-pencil" aria-hidden="true"></i>
                    </span>
                    <span data-title="Delete" data-action="delete">
                      <i class="mdi mdi-delete" aria-hidden="true"></i>
                    </span>
                    <span data-title="Share" data-action="share">
                      <i class="mdi mdi-share-variant" aria-hidden="true"></i>
                    </span>
                    <span data-title="Duplicate" data-action="duplicate">
                      <i class="mdi mdi-content-copy" aria-hidden="true"></i>
                    </span>
                    <span data-title="Shop" onclick="action('shop')">
                      <i class="mdi mdi-cart" aria-hidden="true"></i>
                    </span>
                  </div>
              </div>
              <div>
                {{title}}
                <!-- ${{item_total}} -->
              </div>
            </div>
          </div>
        {{/with}}
      {{/each}}
    </script>
    <script type="text/javascript">
      var boardConfig = {
        backgroundColor: 'rgb(255, 255, 255)',
        backgroundImage: ''
      };

      // when document is ready load all boards
      $(document).ready(function() {
        let apiEndpoint = 'server.php';
        let boardEndpoint = 'index.html';

        let board = [];
        let boardTemplate = Handlebars.compile($('#board-template').html());

        let renderBoard = function() {
          $('#board-list').html(
            boardTemplate({
              board: board
            })
          );
        };

        let createBoard = function(referenceObject, callback) {
          $.post(
            apiEndpoint,
            { operation: 'insert', entity: 'board', data: referenceObject },
            function(response) {
              if (response) {
                if (callback) callback(response);
                else {
                  $.post(
                    apiEndpoint,
                    {
                      operation: 'select',
                      entity: 'board',
                      where: { board_id: response }
                    },
                    function(object) {
                      board.push(object[0]);
                      renderBoard();
                    }
                  );
                }
              }
            }
          );
        };

        let handleAction = function(boardIndex, action) {
          let referenceObject = board[boardIndex];
          switch (action) {
            case 'edit':
              Cookies.set('board_id', referenceObject.board_id);
              window.location.replace(boardEndpoint);
              break;
            case 'delete':
              $.post(
                apiEndpoint,
                {
                  operation: 'update',
                  entity: 'board',
                  data: { is_active: 0 },
                  where: { board_id: referenceObject.board_id }
                },
                function(response) {
                  board.splice(boardIndex, 1);
                  renderBoard();
                }
              );
              break;
            case 'duplicate':
              createBoard({
                user_id: referenceObject.user_id,
                state: referenceObject.state,
                title: 'Copy Of ' + referenceObject.title,
                preview: referenceObject.preview,
                item: referenceObject.item
              });
          }
        };

        $('#board-list').on('click', '[data-action]', function() {
          let boardIndex = $(this)
            .parent()
            .parent()
            .attr('data-board');
          let action = $(this).attr('data-action');

          switch (action) {
            case 'create':
              $('.canvas-config').toggleClass('show');
              $('.backdrop').toggleClass('show');
              break;
            case 'delete':
              $('.confirmation-modal').attr('data-board', boardIndex);
              $('.confirmation-modal').toggleClass('show');
              $('.backdrop').toggleClass('show');
              break;
            default:
              if (boardIndex && boardIndex.length > 0)
                handleAction(boardIndex, action);
          }
        });

        $('.confirmation-modal .btn').click(function() {
          let boardIndex = $('.confirmation-modal').attr('data-board');
          let action = $(this).attr('data-action');
          handleAction(boardIndex, action);
          $('.confirmation-modal').toggleClass('show');
          $('.backdrop').toggleClass('show');
        });

        // get boards from server and render them using a template
        $.post(
          apiEndpoint,
          { operation: 'select', entity: 'board', where: { is_active: 1 } },
          function(response) {
            board = response;
            renderBoard();
          }
        );

        $('.canvas-pallete-color').click(
          e =>
            (boardConfig.backgroundColor = $(e.currentTarget).css(
              'background-color'
            ))
        );
        $('.canvas-pallete-wood-patterns').click(
          e => (boardConfig.backgroundImage = $(e.currentTarget).attr('src'))
        );

        $('.canvas-config .js-btn-go').click(function() {
          console.log('click');
          createBoard(
            {
              user_id: 1,
              title: 'Untitled Board ' + getToday()
            },
            function(response) {
              Cookies.set('backgroundColor', boardConfig.backgroundColor);
              Cookies.set('backgroundImage', boardConfig.backgroundImage);
              Cookies.set('board_id', response);
              window.location.replace(boardEndpoint);
            }
          );
        });

        $('#board-list').on('click', '.edit-board', function() {
          let boardIndex = $(this)
            .find('[data-board]')
            .parent()
            .attr('data-board');
          handleAction(boardIndex, 'edit');
        });

        $('.mdi-heart-outline').on('click', renderBoard);
      });

      function getToday() {
        var today = new Date();
        var dd = String(today.getDate()).padStart(2, '0');
        var mm = String(today.getMonth() + 1).padStart(2, '0'); //January is 0!
        var yyyy = today.getFullYear();

        return mm + '/' + dd + '/' + yyyy;
      }
    </script>
    <script src="./auth.js"></script>
    <script src="./boardConfigure.js"></script>
    <script src="./horizontalScroll.js"></script>
    <script src="./createBoardScript.js"></script>
  </body>
</html>
